<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¡°ì„  ê°œí˜ í€´ì¦ˆ (30ë¬¸ì œ ë²„ì „)</title>
    <!-- Google Tag Manager (Script for Head) -->
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N1YW1EHE33"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-N1YW1EHE33');
</script>
    <!-- End Google Tag Manager -->
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Jua í°íŠ¸ ì„í¬íŠ¸ */
        @import url('https://fonts.googleapis.com/css2?family=Gamja+Flower&display=swap');

        body {
            /* ëª¨ë“  í°íŠ¸ë¥¼ Gamja Flowerë¡œ ë³€ê²½ */
            font-family: 'Gamja Flower', sans-serif;
            background-color: #fff7ed; /* Orange-50 */
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .correct-anim { animation: bounce 0.5s; }
        .wrong-anim { animation: shake 0.5s; }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #f97316;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* AI ì„¤ëª… ì˜ì—­ ìŠ¤íƒ€ì¼ */
        .ai-content strong { font-weight: 200; color: #c2410c; }
        .ai-content ul { list-style-type: disc; margin-left: 1.5rem; margin-top: 0.5rem; }
        .ai-content li { margin-bottom: 0.25rem; }
    </style>
</head>
<body class="bg-orange-50 min-h-screen flex items-center justify-center p-4">
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K64ZFWBJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- ì˜¤ë””ì˜¤ íƒœê·¸ -->
    <audio id="bg-music" autoplay loop>
        <source src="Plum - Timeline.mp3" type="audio/mp3">
    </audio>

    <div class="max-w-md w-full bg-white rounded-2xl shadow-2xl overflow-hidden relative" style="min-height: 750px;">
        
        <!-- í—¤ë” -->
        <div class="bg-orange-600 p-4 text-white text-center absolute top-0 left-0 right-0 z-20 shadow-md h-[120px] flex flex-col justify-center">
            <h1 class="text-3xl font-bold mb-1">ì‚¬íšŒ 5ëª¨ë‘  ë°œí‘œ ë³µìŠµ</h1>
            <p class="text-xl opacity-90">í•µì‹¬ ì™ì™ (30ë¬¸ì œ)</p>
            <button onclick="toggleMusic()" id="music-btn" class="music-btn absolute top-4 right-4 w-10 h-10 rounded-full flex items-center justify-center text-white shadow-lg" title="ë°°ê²½ìŒì•… ì¼œê¸°/ë„ê¸°">
                <i class="fas fa-volume-mute"></i>
            </button>
        </div>

        <div id="progress-container" class="hidden w-full bg-gray-200 h-2 absolute top-[120px] z-20">
            <div id="progress-bar" class="bg-orange-400 h-2 transition-all duration-300" style="width: 0%"></div>
        </div>

        <div id="start-screen" class="absolute inset-0 flex flex-col items-center justify-center p-6 bg-white z-10 fade-in" style="padding-top: 130px;">
            <!-- ì´ë¯¸ì§€ ì ìš© -->
            <div class="mb-8">
                <img src="ì‚¬íšŒì±….jpg" 
                     alt="ì¡°ì„  ê°œí˜ ìºë¦­í„°" 
                     class="w-56 h-56 object-contain mx-auto drop-shadow-xl transform hover:scale-105 transition duration-300"
                     onerror="this.style.display='none'; document.getElementById('fallback-icon').style.display='block';">
                <div id="fallback-icon" class="text-8xl text-orange-500 transform rotate-12 hidden">
                    <i class="fas fa-book-reader"></i>
                </div>
            </div>

            <h2 class="text-4xl font-bold mb-4 text-gray-800 text-center">ì—­ì‚¬ ë§ˆìŠ¤í„° ë„ì „!</h2>
            <p class="text-xl text-gray-600 mb-12 text-center">ì´ 30ë¬¸ì œë¡œ í•µì‹¬ ë‚´ìš©ì„<br>ë¹ ë¥´ê²Œ ë³µìŠµí•´ë´ìš”.</p>
            
            <button onclick="game.start()" class="w-full bg-orange-600 hover:bg-orange-700 text-white font-bold py-4 rounded-xl shadow-lg transition transform hover:scale-105 text-2xl">
                <i class="fas fa-play mr-2"></i> QUIZ START!
            </button>
        </div>

        <!-- í€´ì¦ˆ í™”ë©´ -->
        <div id="quiz-screen" class="hidden absolute inset-0 flex flex-col p-6 overflow-y-auto bg-white z-0" style="padding-top: 150px; padding-bottom: 120px;">
            <div class="mb-4 flex items-center justify-between">
                <span class="px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-lg shadow-sm">
                    Q<span id="q-current">1</span> / <span id="q-total">30</span>
                </span>
                <span id="score-badge" class="text-orange-600 text-lg bg-orange-50 px-2 py-1 rounded">0ì </span>
            </div>

            <h3 id="question-text" class="text-2xl text-gray-800 mb-8 leading-snug break-keep">
                ë¬¸ì œ ë¡œë”© ì¤‘...
            </h3>

            <div id="options-area" class="flex flex-col gap-3">
                <!-- Buttons injected here -->
            </div>
        </div>

        <!-- í”¼ë“œë°± ë° AI ì˜ì—­ -->
        <div id="feedback-area" class="hidden absolute bottom-0 left-0 right-0 bg-white border-t-2 border-orange-100 p-5 rounded-t-2xl shadow-[0_-5px_20px_rgba(0,0,0,0.1)] z-30 fade-in max-h-[80vh] overflow-y-auto flex flex-col">
            
            <div class="flex gap-4 mb-4">
                <div id="feedback-icon" class="text-4xl shrink-0 pt-1"></div>
                <div class="flex-1">
                    <p id="feedback-result" class="text-2xl mb-1"></p>
                    <p id="feedback-detail" class="text-lg text-gray-600 mb-1 leading-relaxed"></p>
                </div>
            </div>

            <div class="border-t border-gray-100 pt-3 mb-3">
                <button id="ai-btn" onclick="game.askAI()" class="w-full bg-indigo-50 text-indigo-700 py-3 rounded-xl hover:bg-indigo-100 transition border border-indigo-200 flex items-center justify-center gap-2 mb-3 text-lg">
                    <i class="fas fa-robot"></i> AI ì„ ìƒë‹˜ê»˜ ìì„¸í•œ í•´ì„¤ ë“£ê¸°
                </button>
                
                <div id="ai-response-area" class="hidden bg-gray-50 p-4 rounded-xl border border-gray-200 text-lg text-gray-700 leading-relaxed ai-content mb-3">
                    <!-- AI Content goes here -->
                </div>
            </div>

            <button onclick="game.nextQuestion()" class="w-full bg-orange-600 text-white py-3 rounded-xl hover:bg-orange-700 transition shadow-md sticky bottom-0 text-xl">
                ë‹¤ìŒ ë¬¸ì œ <i class="fas fa-arrow-right ml-1"></i>
            </button>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div id="result-screen" class="hidden absolute inset-0 flex flex-col items-center justify-center p-6 bg-white z-10" style="padding-top: 120px;">
            <h2 class="text-4xl text-gray-800 mb-2">ìµœì¢… ê²°ê³¼</h2>
            <div class="text-7xl text-orange-600 mb-4">
                <span id="final-score">0</span>ì 
            </div>
            <p id="result-msg" class="text-gray-600 mb-8 text-center text-2xl leading-relaxed"></p>
            
            <div class="w-full bg-gray-50 p-6 rounded-xl mb-6 border border-gray-100">
                <div class="flex justify-between mb-2 text-lg text-gray-500">
                    <span>ì •ë‹µë¥ </span>
                    <span id="final-percent">0%</span>
                </div>
                <div class="w-full bg-gray-200 h-3 rounded-full overflow-hidden">
                    <div id="result-bar" class="bg-orange-500 h-full" style="width: 0%"></div>
                </div>
            </div>

            <button onclick="game.restart()" class="w-full bg-white border-2 border-orange-600 text-orange-600 py-3 rounded-xl hover:bg-orange-50 transition text-2xl">
                <i class="fas fa-redo mr-2"></i>ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </button>
        </div>
    </div>

    <script>
        const apiKey = ""; // API Key injected by environment

        // ë°°ê²½ìŒì•… ì„¤ì •
        const bgMusic = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-btn');
        let isMusicPlaying = false;
        bgMusic.volume = 0.3; 

        function toggleMusic() {
            if (bgMusic.paused) {
                bgMusic.play().then(() => {
                    isMusicPlaying = true;
                    musicBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                }).catch(error => console.log("ìŒì•… ì¬ìƒ ì‹¤íŒ¨:", error));
            } else {
                bgMusic.pause();
                isMusicPlaying = false;
                musicBtn.innerHTML = '<i class="fas fa-volume-mute"></i>';
            }
        }

        // 30ë¬¸ì œë¡œ ì—„ì„ ëœ ë¬¸ì œ ë¦¬ìŠ¤íŠ¸
        const questionsSource = [
            // [ê°‘ì‹ ì •ë³€ - 9ë¬¸ì œ]
            {
                q: "ê°‘ì‹ ì •ë³€ì€ 1884ë…„ ê¸‰ì§„ ê°œí™”íŒŒê°€ ì–´ëŠ ë‚˜ë¼ì˜ ì§€ì›ì„ ë°›ì•„ ì¼ìœ¼ì¼°ë‚˜ìš”?",
                a: ["ì¼ë³¸", "ì²­ë‚˜ë¼", "ë¯¸êµ­", "ëŸ¬ì‹œì•„"],
                correct: 0,
                desc: "1884ë…„ ê¸‰ì§„ ê°œí™”íŒŒëŠ” ì¼ë³¸ì˜ ì§€ì›ì„ ë°›ì•„ ì •ë³€ì„ ì¼ìœ¼ì¼°ìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ ë‹¹ì‹œ ê¸‰ì§„ ê°œí™”íŒŒê°€ í­íƒ„ì„ í„°ëœ¨ë ¤ í˜¼ë€ì„ ì¼ìœ¼í‚¨ ì¥ì†ŒëŠ”?",
                a: ["ìš°ì •êµ­ (ìš°ì •ì´êµ­)", "ê²½ë³µê¶", "ì°½ë•ê¶", "í†µë¦¬ê¸°ë¬´ì•„ë¬¸"],
                correct: 0,
                desc: "1884ë…„ 12ì›” 4ì¼ ìš°ì •êµ­ ì¶•í•˜ì—°ì—ì„œ í­íƒ„ì„ í„°ëœ¨ë ¤ ì •ë³€ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ì˜ í•µì‹¬ ë‚´ìš© ì¤‘ ì²­ë‚˜ë¼ì™€ì˜ ê´€ê³„ì— ëŒ€í•œ ì£¼ì¥ì€?",
                a: ["ì²­ê³¼ì˜ ì¢…ì† ê´€ê³„ë¥¼ ëŠìŒ", "ì²­ê³¼ì˜ ê´€ê³„ë¥¼ ê°•í™”í•¨", "ì²­ì— ì¡°ê³µì„ ëŠ˜ë¦¼", "ì²­ì˜ êµ°ëŒ€ë¥¼ ì£¼ë‘”ì‹œí‚´"],
                correct: 0,
                desc: "ê°œí™”íŒŒëŠ” ì²­ê³¼ì˜ ì¢…ì† ê´€ê³„ë¥¼ ëŠê³  ìì£¼ì  ê·¼ëŒ€ êµ­ê°€ë¥¼ ë§Œë“¤ê³ ì í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ ê°œí˜ ë‚´ìš© ì¤‘ ì‚¬íšŒì  í‰ë“±ì„ ìœ„í•´ íì§€í•˜ê³ ì í–ˆë˜ ê²ƒì€?",
                a: ["ì‹ ë¶„ì œ", "ê³¼ê±°ì œ", "í˜¸í¬ì œ", "ë‹¨ë°œë ¹"],
                correct: 0,
                desc: "ì‹ ë¶„ì œë¥¼ íì§€í•˜ì—¬ ì¸ë¯¼ í‰ë“±ì„ ì‹¤í˜„í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ ì‹¤íŒ¨ì˜ ì£¼ìš” ì›ì¸ì€ ë¬´ì—‡ì¸ê°€ìš”?",
                a: ["ë¯¼ì¤‘ì˜ ì§€ì§€ë¥¼ ì–»ì§€ ëª»í•¨", "ë¯¸êµ­ì˜ ê°œì…", "ì™•ì˜ ë°˜ëŒ€", "ìê¸ˆ ë¶€ì¡±"],
                correct: 0,
                desc: "ê°‘ì‹ ì •ë³€ì€ ë¯¼ì¤‘ì˜ ì§€ì§€ë¥¼ ì–»ì§€ ëª»í–ˆê³ , ì²­êµ°ì˜ ê°œì…ìœ¼ë¡œ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ ë‹¹ì‹œ ê°œí™”íŒŒê°€ ë°œí‘œí•œ 14ê°œì¡° ê°œí˜ì•ˆì˜ ì´ë¦„ì€?",
                a: ["14ê°œì¡° ê°œí˜ ì •ê°•", "í™ë²” 14ì¡°", "í—Œì˜ 6ì¡°", "ëŒ€í•œêµ­ êµ­ì œ"],
                correct: 0,
                desc: "ê°‘ì‹ ì •ë³€ ë•ŒëŠ” '14ê°œì¡°ì˜ ê°œí˜ë°©ì•ˆ(ì •ê°•)'ì„ ë°œí‘œí–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ì„ ì£¼ë„í•œ 'ê¸‰ì§„ ê°œí™”íŒŒ' ì¸ë¬¼ì´ ì•„ë‹Œ ì‚¬ëŒì€?",
                a: ["ìµœìµí˜„", "ê¹€ì˜¥ê· ", "ë°•ì˜íš¨", "ì„œì¬í•„"],
                correct: 0,
                desc: "ìµœìµí˜„ì€ ìœ„ì •ì²™ì‚¬íŒŒ ì¸ë¬¼ì…ë‹ˆë‹¤. ë‚˜ë¨¸ì§€ëŠ” ê°‘ì‹ ì •ë³€ ì£¼ì—­ë“¤ì…ë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ì€ ë©°ì¹  ë§Œì— ëì´ ë‚¬ë‚˜ìš”?",
                a: ["3ì¼", "5ì¼", "7ì¼", "10ì¼"],
                correct: 0,
                desc: "ê°‘ì‹ ì •ë³€ì€ '3ì¼ ì²œí•˜'ë¡œ ë¶ˆë¦¬ë©° 3ì¼ ë§Œì— ë§‰ì„ ë‚´ë ¸ìŠµë‹ˆë‹¤."
            },
            {
                q: "ê°‘ì‹ ì •ë³€ ë‹¹ì‹œ ê°œí™”íŒŒê°€ ëª¨ë¸ë¡œ ì‚¼ì•˜ë˜ ì¼ë³¸ì˜ ê°œí˜ì€?",
                a: ["ë©”ì´ì§€ ìœ ì‹ ", "ë‹¤ì´ì¹´ ê°œì‹ ", "ë§‰ë¶€ ì •ì¹˜", "ì‡¼êµ° í†µì¹˜"],
                correct: 0,
                desc: "ì¼ë³¸ì˜ ë©”ì´ì§€ ìœ ì‹ ì„ ë³¸ë–  ê·¼ëŒ€ êµ­ê°€ë¥¼ ê±´ì„¤í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤."
            },

            // [ë™í•™ ë†ë¯¼ ìš´ë™ - 2ë¬¸ì œ]
            {
                q: "ë™í•™ ë†ë¯¼ ìš´ë™ì´ ì¼ì–´ë‚˜ê²Œ ëœ ì‚¬íšŒì  ë°°ê²½ì€?",
                a: ["ë™í•™ì˜ í™•ì‚°ê³¼ ë†ë¯¼ ìˆ˜íƒˆ", "ì²œì£¼êµì˜ ì „íŒŒ", "ì™•ê¶Œì˜ ê°•í™”", "ë¬´ì—­ì˜ ë°œë‹¬"],
                correct: 0,
                desc: "ë†ë¯¼ë“¤ ì‚¬ì´ì— ë™í•™ì´ ë„ë¦¬ í¼ì§€ê³  ì‚¬íšŒì  ëª¨ìˆœì´ ì‹¬í™”ëœ ê²ƒì´ ë°°ê²½ì…ë‹ˆë‹¤."
            },
            {
                q: "ë™í•™ ë†ë¯¼ ìš´ë™ì´ ìš°ë¦¬ë‚˜ë¼ ì—­ì‚¬ì— ë¼ì¹œ ì˜í–¥ì€?",
                a: ["ê·¼ëŒ€ì  êµ­ê°€ì˜ ë°œíŒì´ ë¨", "ì‹ ë¶„ì œë¥¼ ê°•í™”í•¨", "ì‡„êµ­ ì •ì±…ì„ ê°•í™”í•¨", "ì²­ë‚˜ë¼ ì œë„ë¥¼ ë„ì…í•¨"],
                correct: 0,
                desc: "ë™í•™ ë†ë¯¼ ìš´ë™ì€ ì´í›„ ê°‘ì˜¤ê°œí˜ ë“±ì— ì˜í–¥ì„ ì£¼ì–´ ê·¼ëŒ€ êµ­ê°€ì˜ ë°œíŒì´ ë˜ì—ˆìŠµë‹ˆë‹¤."
            },

            // [1ì°¨ ê°‘ì˜¤ê°œí˜ - 9ë¬¸ì œ]
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ëŠ¥ë ¥ì— ë”°ë¥¸ ê´€ë¦¬ ë“±ìš©ì„ ìœ„í•´ íì§€í•œ ì œë„ëŠ”?",
                a: ["ê³¼ê±°ì œ", "ìŒì„œì œ", "ì²œê±°ì œ", "ê³µìŒì „"],
                correct: 0,
                desc: "ê³¼ê±°ì œë¥¼ íì§€í•˜ê³  ì‹ ë¶„ì— ìƒê´€ì—†ì´ ì¸ì¬ë¥¼ ë“±ìš©í•˜ë ¤ í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ì™•ê¶Œì„ ì•½í™”ì‹œí‚¤ê³  ë‚´ê° ê¶Œí•œì„ ê°•í™”í•˜ê¸° ìœ„í•´ ì¤‘ì‹¬ìœ¼ë¡œ ì‚¼ì€ ê¸°êµ¬ëŠ”?",
                a: ["ì˜ì •ë¶€", "ë¹„ë³€ì‚¬", "ìŠ¹ì •ì›", "ì‚¬í—Œë¶€"],
                correct: 0,
                desc: "ì˜ì •ë¶€ ì¤‘ì‹¬ ì²´ì œë¥¼ ê°•í™”í•˜ì—¬ ì™•ê¶Œì„ ê²¬ì œí•˜ê³  ë‚´ê° ì±…ì„ì œë¥¼ ì¶”êµ¬í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ ê²½ì œ ë¶„ì•¼ì—ì„œ ì„¸ê¸ˆì„ ë¬´ì—‡ìœ¼ë¡œ ë‚´ê²Œ í–ˆë‚˜ìš”?",
                a: ["í™”í (ì¡°ì„¸ ê¸‰ë‚©í™”)", "ìŒ€", "íŠ¹ì‚°ë¬¼", "ì˜·ê°"],
                correct: 0,
                desc: "ì„¸ê¸ˆì„ ë¬¼ê±´ì´ ì•„ë‹Œ í™”íë¡œ ë‚´ê²Œ í•˜ëŠ” 'ì¡°ì„¸ ê¸‰ë‚©í™”'ë¥¼ ì‹¤ì‹œí–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ê²½ì œ í™œë™ì˜ íš¨ìœ¨ì„±ì„ ìœ„í•´ í†µì¼í•œ ê²ƒì€?",
                a: ["ë„ëŸ‰í˜•", "í™”í ë‹¨ìœ„", "ë„ë¡œ í­", "ìˆ˜ë ˆ ë°”í€´"],
                correct: 0,
                desc: "ê¸¸ì´ì™€ ë¶€í”¼ ë“±ì„ ì¬ëŠ” ë„ëŸ‰í˜•ì„ í†µì¼í•˜ì—¬ ê²½ì œì  íš¨ìœ¨ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ ì‚¬íšŒ ë¶„ì•¼ì˜ ê°€ì¥ í° ë³€í™”ë¡œ, í‰ë“± ì‚¬íšŒì˜ ê¸°ì´ˆê°€ ëœ ê²ƒì€?",
                a: ["ì‹ ë¶„ì œ íì§€", "í˜¸íŒ¨ë²• íì§€", "í†µí–‰ê¸ˆì§€ í•´ì œ", "ìƒë³µ ì œë„ ë³€ê²½"],
                correct: 0,
                desc: "ê³µì‚¬ ë…¸ë¹„ë²•ì„ í˜íŒŒí•˜ì—¬ ë²•ì ìœ¼ë¡œ ì‹ ë¶„ì œë¥¼ íì§€í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ì—¬ì„±ê³¼ ì–´ë¦°ì´ì˜ ì¸ê¶Œì„ ìœ„í•´ ê¸ˆì§€í•œ ê²ƒì€?",
                a: ["ì¡°í˜¼ (ì¼ì° ê²°í˜¼)", "ì¬í˜¼", "ìƒì†", "êµìœ¡"],
                correct: 0,
                desc: "ì–´ë¦° ë‚˜ì´ì— ê²°í˜¼í•˜ëŠ” ì¡°í˜¼ì„ ê¸ˆì§€í•˜ì—¬ ì¸ê¶Œì„ ë³´í˜¸í•˜ë ¤ í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ê³¼ë¶€(ë‚¨í¸ ìƒì€ ì—¬ì„±)ì—ê²Œ í—ˆìš©í•œ ê²ƒì€?",
                a: ["ì¬í˜¼ (ê°œê°€)", "ê³¼ê±° ì‘ì‹œ", "ê´€ì§ ì§„ì¶œ", "í† ì§€ ì†Œìœ "],
                correct: 0,
                desc: "ê³¼ë¶€ì˜ ì¬í˜¼ì„ í—ˆìš©í•˜ì—¬ ì—¬ì„±ì˜ ê¶Œë¦¬ë¥¼ ì¼ë¶€ ì‹ ì¥ì‹œì¼°ìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ êµ°ì‚¬ ë¶„ì•¼ ê°œí˜ì˜ ë‚´ìš©ì€?",
                a: ["êµ°ì‚¬ ì¡°ì§ ì¬í¸ì„±", "í•´êµ° ì°½ì„¤", "ì§•ë³‘ì œ ì „ë©´ ì‹¤ì‹œ", "ë¬´ê¸° ê³µì¥ ì„¤ë¦½"],
                correct: 0,
                desc: "ê¸°ì¡´ êµ°ì˜ì„ í†µí•©í•˜ê³  êµ°ì‚¬ ì¡°ì§ì„ ê·¼ëŒ€ì ìœ¼ë¡œ ì¬í¸ì„±í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "1ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ì–¸ë¡  ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ë˜ 'ì´ ê¸°êµ¬'ì˜ ê¸°ëŠ¥ì„ ì¶•ì†Œì‹œì¼°ìŠµë‹ˆë‹¤. ë¬´ì—‡ì¼ê¹Œìš”?",
                a: ["ì‚¼ì‚¬", "ìœ¡ì¡°", "ì˜ê¸ˆë¶€", "í¬ë„ì²­"],
                correct: 0,
                desc: "ë‚´ê° ì²´ì œ ê°•í™”ë¥¼ ìœ„í•´ ë¹„íŒ ê¸°ëŠ¥ì„ ê°€ì§„ ì‚¼ì‚¬ì˜ ê¶Œí•œì„ ì¶•ì†Œí–ˆìŠµë‹ˆë‹¤."
            },

            // [ì„¸ë„ ì •ì¹˜ - 2ë¬¸ì œ]
            {
                q: "'ì„¸ë„ ì •ì¹˜'ë€ ì–´ë–¤ ì •ì¹˜ í˜•íƒœë¥¼ ë§í•˜ë‚˜ìš”?",
                a: ["íŠ¹ì • ê°€ë¬¸ì´ ê¶Œë ¥ì„ ë…ì í•˜ëŠ” í˜•íƒœ", "ì™•ì´ ê°•ë ¥í•œ ê¶Œë ¥ì„ ê°€ì§„ í˜•íƒœ", "ë°±ì„±ì´ íˆ¬í‘œí•˜ëŠ” í˜•íƒœ", "ì‹ í•˜ë“¤ì´ ê³¨ê³ ë£¨ ì°¸ì—¬í•˜ëŠ” í˜•íƒœ"],
                correct: 0,
                desc: "ì™•ì˜ ì™¸ì²™ ë“± ì†Œìˆ˜ íŠ¹ì • ê°€ë¬¸ì´ ê¶Œë ¥ì„ ë…ì í•˜ì—¬ êµ­ì •ì„ ì¢Œì§€ìš°ì§€í•œ ì •ì¹˜ì…ë‹ˆë‹¤."
            },
            {
                q: "ì„¸ë„ ì •ì¹˜ì˜ íí•´ë¡œ ì•Œë§ì€ ê²ƒì€?",
                a: ["ë§¤ê´€ë§¤ì§ê³¼ ì‚¼ì •ì˜ ë¬¸ë€", "ìƒì—…ì˜ ê¸‰ê²©í•œ ë°œë‹¬", "ê³¼í•™ ê¸°ìˆ ì˜ ë°œì „", "ì‹ ë¶„ì œ ì•½í™”"],
                correct: 0,
                desc: "ì„¸ë„ ì •ì¹˜ ì‹œê¸°ì—ëŠ” ë²¼ìŠ¬ì„ ì‚¬ê³ íŒŒëŠ” ë§¤ê´€ë§¤ì§ê³¼ ì¡°ì„¸ ìˆ˜íƒˆ(ì‚¼ì •ì˜ ë¬¸ë€)ì´ ê·¹ì‹¬í–ˆìŠµë‹ˆë‹¤."
            },

            // [2ì°¨ ê°‘ì˜¤ê°œí˜ - 6ë¬¸ì œ]
            {
                q: "2ì°¨ ê°‘ì˜¤ê°œí˜ ë•Œ ê³ ì¢…ì´ ë°œí‘œí•œ ìì£¼ ë…ë¦½ê³¼ ê·¼ëŒ€í™”ì˜ ì˜ì§€ë¥¼ ë‹´ì€ ë¬¸ì„œëŠ”?",
                a: ["í™ë²” 14ì¡°", "í—Œì˜ 6ì¡°", "ë…ë¦½ ì„ ì–¸ì„œ", "ì„ì‚¬ì¡°ì•½"],
                correct: 0,
                desc: "êµ­ì • ê°œí˜ì˜ ê¸°ë³¸ ê°•ë ¹ì¸ 'í™ë²” 14ì¡°'ë¥¼ ì¢…ë¬˜ì— ë°”ì¹˜ê³  ë°œí‘œí–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "2ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ êµ­ê°€ ì¬ì •ì„ íˆ¬ëª…í•˜ê²Œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ë„ì…í•œ ì œë„ëŠ”?",
                a: ["ì˜ˆì‚°ì œ", "ê²°ì‚°ì œ", "ë³µì‹ë¶€ê¸°", "ì€í–‰ì œ"],
                correct: 0,
                desc: "êµ­ê°€ ìˆ˜ì…ê³¼ ì§€ì¶œì„ ë¯¸ë¦¬ ê³„íší•˜ëŠ” ì˜ˆì‚°ì œë¥¼ ë„ì…í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "2ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ì±„íƒí•œ ê·¼ëŒ€ì  í™”í ì œë„ëŠ”?",
                a: ["ì€ë³¸ìœ„ì œ", "ê¸ˆë³¸ìœ„ì œ", "ì „í‘œì œ", "ë¬¼ë¬¼êµí™˜"],
                correct: 0,
                desc: "ì€ì„ í™”í ê°€ì¹˜ì˜ ê¸°ì¤€ìœ¼ë¡œ ì‚¼ëŠ” ì€ë³¸ìœ„ í™”í ì œë„ë¥¼ ì‹¤ì‹œí–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "2ì°¨ ê°‘ì˜¤ê°œí˜ ì‚¬ë²• ë¶„ì•¼ì˜ ë³€í™”ë¡œ ì•Œë§ì€ ê²ƒì€?",
                a: ["ì¬íŒì†Œ ì„¤ì¹˜", "ì˜ê¸ˆë¶€ ë¶€í™œ", "í¬ë„ì²­ ê¶Œí•œ ê°•í™”", "ì¥í˜•(ê³¤ì¥) ë¶€í™œ"],
                correct: 0,
                desc: "ì§€ë°©ê´€ì˜ ì‚¬ë²•ê¶Œì„ ë°•íƒˆí•˜ê³  ê·¼ëŒ€ì  ì¬íŒì†Œë¥¼ ì„¤ì¹˜í•˜ì—¬ ì‚¬ë²•ê¶Œì„ ë…ë¦½ì‹œì¼°ìŠµë‹ˆë‹¤."
            },
            {
                q: "2ì°¨ ê°‘ì˜¤ê°œí˜ êµìœ¡ ë¶„ì•¼ì—ì„œ ë°œí‘œëœ ì¹™ë ¹ì€?",
                a: ["êµìœ¡ ì…êµ­ ì¡°ì„œ", "ê²½êµ­ëŒ€ì „", "ì†ëŒ€ì „", "í›ˆë¯¼ì •ìŒ"],
                correct: 0,
                desc: "ê·¼ëŒ€ì  êµìœ¡ì„ ê°•ì¡°í•˜ëŠ” 'êµìœ¡ ì…êµ­ ì¡°ì„œ'ë¥¼ ë°˜í¬í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "2ì°¨ ê°‘ì˜¤ê°œí˜ì—ì„œ ë‚´ê° ì¤‘ì‹¬ì œë¥¼ ê°•í™”í•˜ì—¬ í™•ë¦½í•˜ê³ ì í–ˆë˜ ê²ƒì€?",
                a: ["ê·¼ëŒ€ì  ê´€ë£Œì œ", "ë´‰ê±´ì  ì‹ ë¶„ì œ", "ì™•ì‹¤ì˜ ê¶Œìœ„", "ì§€ë°© í† í˜¸ ì„¸ë ¥"],
                correct: 0,
                desc: "ë‚´ê°ì˜ ê¶Œí•œì„ ê°•í™”í•˜ì—¬ ê·¼ëŒ€ì ì¸ í–‰ì • ê´€ë£Œ ì²´ì œë¥¼ í™•ë¦½í•˜ë ¤ í–ˆìŠµë‹ˆë‹¤."
            },

            // [ì¢…í•© - 2ë¬¸ì œ]
            {
                q: "ê°‘ì‹ ì •ë³€ê³¼ ê°‘ì˜¤ê°œí˜ì˜ ê³µí†µì ì¸ ì§€í–¥ì ì€ ë¬´ì—‡ì¸ê°€ìš”?",
                a: ["ê·¼ëŒ€ êµ­ê°€ ê±´ì„¤ê³¼ ì‹ ë¶„ì œ ì² í", "ì™•ê¶Œ ê°•í™”ì™€ ì‡„êµ­ ì •ì±…", "ì²­ë‚˜ë¼ì™€ì˜ ê´€ê³„ ê°•í™”", "ì„±ë¦¬í•™ì  ì§ˆì„œ ìœ ì§€"],
                correct: 0,
                desc: "ë‘ ì‚¬ê±´ ëª¨ë‘ ë‚¡ì€ ì§ˆì„œë¥¼ íƒ€íŒŒí•˜ê³  í‰ë“±í•œ ê·¼ëŒ€ êµ­ê°€ë¥¼ ë§Œë“¤ê³ ì í–ˆìŠµë‹ˆë‹¤."
            },
            {
                q: "ë‹¤ìŒ ì‚¬ê±´ì„ ì¼ì–´ë‚œ ìˆœì„œëŒ€ë¡œ ë°”ë¥´ê²Œ ë‚˜ì—´í•œ ê²ƒì€?",
                a: ["ê°‘ì‹ ì •ë³€ â†’ ë™í•™ ë†ë¯¼ ìš´ë™ â†’ ê°‘ì˜¤ê°œí˜", "ê°‘ì˜¤ê°œí˜ â†’ ê°‘ì‹ ì •ë³€ â†’ ë™í•™ ë†ë¯¼ ìš´ë™", "ë™í•™ ë†ë¯¼ ìš´ë™ â†’ ê°‘ì‹ ì •ë³€ â†’ ê°‘ì˜¤ê°œí˜", "ê°‘ì‹ ì •ë³€ â†’ ê°‘ì˜¤ê°œí˜ â†’ ë™í•™ ë†ë¯¼ ìš´ë™"],
                correct: 0,
                desc: "ê°‘ì‹ ì •ë³€(1884) â†’ ë™í•™ ë†ë¯¼ ìš´ë™(1894 ë´„) â†’ 1ì°¨ ê°‘ì˜¤ê°œí˜(1894 ì—¬ë¦„) ìˆœì„œì…ë‹ˆë‹¤."
            }
        ];

        let questions = []; 

        const game = {
            currentIdx: 0,
            score: 0,
            isAnswering: false,

            start: function() {
                // ìŒì•… ìë™ ì¬ìƒ ì‹œë„
                if (bgMusic.paused) {
                    bgMusic.play().then(() => {
                        isMusicPlaying = true;
                        musicBtn.innerHTML = '<i class="fas fa-volume-up"></i>';
                    }).catch(e => {
                        console.log("ìë™ ì¬ìƒ ì •ì±…ìœ¼ë¡œ ì¸í•´ í´ë¦­ í›„ ì¬ìƒë©ë‹ˆë‹¤.");
                    });
                }

                this.currentIdx = 0;
                this.score = 0;
                
                // ë¬¸ì œ ì„ê¸°
                questions = [...questionsSource];
                for (let i = questions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [questions[i], questions[j]] = [questions[j], questions[i]];
                }

                document.getElementById('q-total').innerText = questions.length;
                document.getElementById('start-screen').classList.add('hidden');
                document.getElementById('quiz-screen').classList.remove('hidden');
                document.getElementById('result-screen').classList.add('hidden');
                document.getElementById('progress-container').classList.remove('hidden');
                this.renderQuestion();
            },

            renderQuestion: function() {
                this.isAnswering = true;
                const q = questions[this.currentIdx];
                
                document.getElementById('q-current').innerText = this.currentIdx + 1;
                document.getElementById('score-badge').innerText = Math.round(this.score) + "ì ";
                document.getElementById('question-text').innerText = q.q;
                
                const percent = ((this.currentIdx) / questions.length) * 100;
                document.getElementById('progress-bar').style.width = percent + "%";

                const optionsArea = document.getElementById('options-area');
                optionsArea.innerHTML = '';
                
                document.getElementById('feedback-area').classList.add('hidden');
                document.getElementById('ai-response-area').classList.add('hidden');
                document.getElementById('ai-btn').classList.remove('hidden');
                document.getElementById('ai-btn').innerHTML = '<i class="fas fa-robot"></i> AI ì„ ìƒë‹˜ê»˜ ìì„¸í•œ í•´ì„¤ ë“£ê¸°';
                document.getElementById('ai-btn').disabled = false;

                let options = q.a.map((text, idx) => ({ text, isCorrect: idx === q.correct }));
                for (let i = options.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [options[i], options[j]] = [options[j], options[i]];
                }

                options.forEach((opt) => {
                    const btn = document.createElement('button');
                    btn.className = "w-full text-left p-4 rounded-xl border-2 border-orange-100 hover:border-orange-400 hover:bg-orange-50 transition duration-200 font-medium text-gray-700 active:scale-95 text-xl";
                    btn.innerText = opt.text;
                    btn.onclick = () => this.checkAnswer(opt.isCorrect, btn, options, q.desc);
                    optionsArea.appendChild(btn);
                });
            },

            checkAnswer: function(isCorrect, btnClicked, options, desc) {
                if(!this.isAnswering) return;
                this.isAnswering = false;

                const buttons = document.getElementById('options-area').children;
                const pointsPerQuestion = 100 / questions.length; // 30ë¬¸ì œë©´ ì•½ 3.33ì 

                if(isCorrect) {
                    this.score += pointsPerQuestion;
                    btnClicked.classList.add('bg-orange-100', 'border-orange-500', 'text-orange-900');
                    this.showFeedback(true, desc);
                } else {
                    btnClicked.classList.add('bg-red-100', 'border-red-500', 'text-red-900');
                    for(let i=0; i<options.length; i++) {
                        if(options[i].isCorrect) {
                            buttons[i].classList.add('bg-orange-100', 'border-orange-500', 'text-orange-900');
                        }
                    }
                    this.showFeedback(false, desc);
                }
                
                document.getElementById('score-badge').innerText = Math.round(this.score) + "ì ";
            },

            showFeedback: function(isCorrect, desc) {
                const fbArea = document.getElementById('feedback-area');
                const icon = document.getElementById('feedback-icon');
                const result = document.getElementById('feedback-result');
                const detail = document.getElementById('feedback-detail');

                fbArea.classList.remove('hidden');
                
                if(isCorrect) {
                    icon.innerHTML = '<i class="fas fa-check-circle text-orange-500 correct-anim"></i>';
                    result.innerText = "ì •ë‹µì…ë‹ˆë‹¤!";
                    result.className = "text-xl text-orange-600";
                } else {
                    icon.innerHTML = '<i class="fas fa-times-circle text-red-500 wrong-anim"></i>';
                    result.innerText = "ì•„ì‰½ë„¤ìš”!";
                    result.className = "text-xl text-red-600";
                }
                detail.innerText = desc;
            },

            askAI: async function() {
                const q = questions[this.currentIdx];
                const btn = document.getElementById('ai-btn');
                const output = document.getElementById('ai-response-area');
                
                btn.innerHTML = '<span class="loader mr-2"></span> ì„ ìƒë‹˜ì´ ìƒê° ì¤‘ì´ì—ìš”...';
                btn.disabled = true;

                try {
                    const correctText = q.a[q.correct];
                    const prompt = `
                        ë„ˆëŠ” ì¹œì ˆí•˜ê³  í•´ë°•í•œ í•œêµ­ì‚¬ ì„ ìƒë‹˜ì´ì•¼.
                        ì´ˆë“±í•™êµ~ì¤‘í•™êµ ìˆ˜ì¤€ì˜ í•™ìƒì—ê²Œ ì•„ë˜ ì—­ì‚¬ ë¬¸ì œì— ëŒ€í•´ ì‰½ê³  ì¬ë¯¸ìˆê²Œ ì„¤ëª…í•´ì¤˜.
                        
                        [ë¬¸ì œ] ${q.q}
                        [ì •ë‹µ] ${correctText}
                        [í•µì‹¬ ì„¤ëª…] ${q.desc}
                        
                        ìš”ì²­ì‚¬í•­:
                        1. ì •ë‹µì´ ì™œ ì •ë‹µì¸ì§€ ë°°ê²½ ì´ì•¼ê¸°ë¥¼ í¬í•¨í•´ì„œ ì„¤ëª…í•´ì¤˜.
                        2. ì¤‘ìš”í•œ ì—­ì‚¬ì  ì˜ì˜ë¥¼ í•œ ì¤„ ìš”ì•½í•´ì¤˜.
                        3. ë§íˆ¬ëŠ” ì¹œì ˆí•˜ê²Œ "í•´ìš”"ì²´ë¥¼ ì¨ì¤˜.
                        4. ë„ˆë¬´ ê¸¸ì§€ ì•Šê²Œ 300ì ë‚´ì™¸ë¡œ í•µì‹¬ë§Œ ìš”ì•½í•´ì¤˜.
                    `;

                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });

                    if (!response.ok) throw new Error('API í˜¸ì¶œ ì‹¤íŒ¨');

                    const data = await response.json();
                    const text = data.candidates[0].content.parts[0].text;
                    const formattedText = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>').replace(/\n/g, '<br>');

                    output.innerHTML = formattedText;
                    output.classList.remove('hidden');
                    btn.classList.add('hidden');

                } catch (error) {
                    console.error(error);
                    btn.innerHTML = '<i class="fas fa-exclamation-circle"></i> ì„ ìƒë‹˜ì´ ë°”ë¹ ìš”. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
                    btn.disabled = false;
                }
            },

            nextQuestion: function() {
                this.currentIdx++;
                if(this.currentIdx < questions.length) {
                    this.renderQuestion();
                } else {
                    this.finishGame();
                }
            },

            finishGame: function() {
                document.getElementById('quiz-screen').classList.add('hidden');
                document.getElementById('feedback-area').classList.add('hidden');
                document.getElementById('progress-container').classList.add('hidden');
                document.getElementById('result-screen').classList.remove('hidden');

                const finalScore = Math.round(this.score);
                document.getElementById('final-score').innerText = finalScore;
                
                const percent = finalScore; 
                document.getElementById('final-percent').innerText = percent + "%";
                document.getElementById('result-bar').style.width = percent + "%";

                let msg = "";
                if(finalScore >= 95) {
                    msg = "ì™„ë²½í•´ìš”!! ì—­ì‚¬ ë°•ì‚¬ë‹˜ì´ì‹œë„¤ìš”! ğŸ†";
                } else if(finalScore >= 80) {
                    msg = "ì°¸ ì˜í–ˆì–´ìš”! ì¡°ê¸ˆë§Œ ë” í•˜ë©´ ë§Œì ì´ì—ìš”. ğŸ‘";
                } else if(finalScore >= 50) {
                    msg = "ìˆ˜ê³ í–ˆì–´ìš”! ë³µìŠµì„ ì¡°ê¸ˆ ë” í•´ë³¼ê¹Œìš”? ğŸ‘";
                } else {
                    msg = "ì•„ì‰¬ì›Œìš”. ì²˜ìŒë¶€í„° ì°¨ê·¼ì°¨ê·¼ ë‹¤ì‹œ ê³µë¶€í•´ë³´ì•„ìš”. ğŸ“š";
                }
                
                document.getElementById('result-msg').innerText = msg;
            },
            
            restart: function() { this.start(); }
        };
    </script>
</body>
</html>
